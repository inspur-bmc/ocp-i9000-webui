(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e4e5f5a"],{"01af":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view-content",{attrs:{message:"fwUpdate"},on:{refresh:t.refresh}},[a("a-row",[a("a-col",{attrs:{span:24}},[a("a-steps",{attrs:{direction:"horizontal",current:t.currentStep}},[a("a-step",{attrs:{title:t.$t("message.fwUpdate.fw_update_entrance")}}),a("a-step",{attrs:{title:t.$t("message.fwUpdate.fw_src")}}),a("a-step",{attrs:{title:t.$t("message.fwUpdate.fw_file")}}),a("a-step",{attrs:{title:t.$t("message.fwUpdate.fw_update")}})],1)],1)],1),a("a-row",{staticStyle:{"margin-bottom":"20px"}},[a("a-col",{attrs:{span:24}},[a("div",{staticClass:"step-content"},[0==t.currentStep?a("div",{attrs:{id:"fw-update-entrance"}},[a("div",{staticClass:"fwupdate-warning"},[a("div",{staticClass:"warning-title"},[t._v(t._s(t.$t("message.fwUpdate.fw_update_warning_title")))]),a("div",{staticClass:"warning-msg"},[t._v(t._s(t.$t("message.fwUpdate.fw_update_warning_msg")))]),a("div",[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return e.preventDefault(),t.enterFwUpdate(e)}}},[t._v(t._s(t.$t("message.fwUpdate.fw_update_entrance")))])],1)])]):t._e(),1==t.currentStep?a("div",{attrs:{id:"fw-src"}},[a("a-form",[a("a-form-item",{attrs:{label:t.$t("message.fwUpdate.fw_src"),labelCol:{span:4},wrapperCol:{span:10},"validate-status":t.fwSrcError,help:t.fwSrcHint}},[a("a-radio-group",{attrs:{disabled:""},model:{value:t.fwSrc,callback:function(e){t.fwSrc=e},expression:"fwSrc"}},[a("a-radio",{attrs:{value:"local"}},[t._v(t._s(t.$t("message.fwUpdate.local_fw")))]),a("a-radio",{attrs:{value:"tftp"}},[t._v(t._s(t.$t("message.fwUpdate.tftp_fw")))])],1)],1),a("a-form-item",{attrs:{labelCol:{span:4},wrapperCol:{span:4,offset:4}}},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return e.preventDefault(),t.stepToUpload(e)}}},[t._v(t._s(t.$t("message.fwUpdate.next")))])],1)],1)],1):t._e(),2==t.currentStep?a("div",{attrs:{id:"fw-file"}},["local"===t.fwSrc?a("a-row",{staticStyle:{"margin-bottom":"20px"}},[a("a-col",{attrs:{span:24}},[a("a-upload-dragger",{attrs:{name:"file",beforeUpload:t.beforeUpload,fileList:t.fileList},on:{change:t.handleChange}},[a("p",{staticClass:"ant-upload-drag-icon"},[a("a-icon",{attrs:{type:"inbox"}})],1),a("p",{staticClass:"ant-upload-text"},[t._v(t._s(t.$t("message.fwUpdate.upload_text")))]),a("p",{staticClass:"ant-upload-hint"},[t._v(t._s(t.$t("message.fwUpdate.upload_hint")))])])],1)],1):t._e(),"tftp"===t.fwSrc?a("a-row",{staticStyle:{"margin-bottom":"20px"}},[a("a-col",{attrs:{span:24}},[a("a-form",[a("a-form-item",{attrs:{label:t.$t("message.fwUpdate.tftp_addr"),labelCol:{span:4},wrapperCol:{span:4},"validate-status":t.tftpAddrError,help:t.tftpAddrHint,"has-feedback":""}},[a("a-input",{attrs:{placeholder:t.$t("message.fwUpdate.tftp_addr_placeholder")},model:{value:t.tftpAddr,callback:function(e){t.tftpAddr=e},expression:"tftpAddr"}})],1),a("a-form-item",{attrs:{label:t.$t("message.fwUpdate.tftp_file"),labelCol:{span:4},wrapperCol:{span:4},"validate-status":t.fileNameError,help:t.fileNameHint,"has-feedback":""}},[a("a-input",{attrs:{placeholder:t.$t("message.fwUpdate.tftp_file")},model:{value:t.fileName,callback:function(e){t.fileName=e},expression:"fileName"}})],1)],1)],1)],1):t._e(),a("a-row",{staticStyle:{"text-align":"center"}},["local"===t.fwSrc?a("a-button",{attrs:{loading:t.fileLoading,icon:"upload",type:"primary"},on:{click:t.upload}},[t._v(t._s(t.$t("message.common.upload")))]):t._e(),"tftp"===t.fwSrc?a("a-button",{attrs:{loading:t.fileLoading,icon:"download",type:"primary"},on:{click:t.download}},[t._v(t._s(t.$t("message.common.download")))]):t._e(),a("a-button",{staticStyle:{"margin-left":"20px"},attrs:{disabled:!t.imgReady,type:"primary"},on:{click:function(){t.currentStep=3}}},[t._v(t._s(t.$t("message.fwUpdate.next")))]),a("a-button",{staticStyle:{"margin-left":"20px"},attrs:{disabled:t.imgReady||t.fileLoading},on:{click:function(){t.currentStep=1}}},[t._v(t._s(t.$t("message.fwUpdate.previous")))])],1)],1):t._e(),3==t.currentStep?a("div",{attrs:{id:"fw-flash"}},[a("div",{staticClass:"fwupdate-warning"},[a("div",{staticClass:"warning-title"},[t._v(t._s(t.$t("message.fwUpdate.fw_update_warning_title")))]),a("div",{staticClass:"warning-msg"},[t._v(t._s(t.$t("message.fwUpdate.flash_warning_msg")))]),a("div",[a("a-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:t.warmReboot}},[t._v(t._s(t.$t("message.fwUpdate.flash")))])],1)])]):t._e()]),0!=t.currentStep?a("div",{staticClass:"abort-button"},[a("a-button",{attrs:{size:"large"},on:{click:function(e){return e.preventDefault(),t.abortFwUpdate(e)}}},[t._v(t._s(t.$t("message.fwUpdate.abort")))])],1):t._e()])],1)],1)},s=[],n=a("a34a"),i=a.n(n),o=a("a396"),c=a("2f62"),l=a("a9da");function p(t,e,a,r,s,n,i){try{var o=t[n](i),c=o.value}catch(l){return void a(l)}o.done?e(c):Promise.resolve(c).then(r,s)}function f(t){return function(){var e=this,a=arguments;return new Promise(function(r,s){var n=t.apply(e,a);function i(t){p(n,r,s,i,o,"next",t)}function o(t){p(n,r,s,i,o,"throw",t)}i(void 0)})}}function d(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},r=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),r.forEach(function(e){u(t,e,a[e])})}return t}function u(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var m={name:"fwUpdate",data:function(){return{currentStep:0,fwSrc:"tftp",fileList:[],fwSrcError:"",tftpAddr:void 0,tftpAddrError:"",fileName:void 0,fileNameError:"",imageRedyFlag:!1,intervalID:0,fileLoading:!1,imgReady:!1}},computed:{fwSrcHint:function(){return"error"===this.fwSrcError?this.$t("message.fwUpdate.fw_src_error"):""},tftpAddrHint:function(){return"error"===this.tftpAddrError?this.$t("message.fwUpdate.tftp_addr_error"):""},fileNameHint:function(){return"error"===this.fileNameError?this.$t("message.fwUpdate.tftp_file_error"):""}},watch:{fwSrc:function(t){t&&(this.fwSrcError="success")},tftpAddr:function(t){this.tftpAddrError=t?"success":"error"},fileName:function(t){this.fileNameError=t?"success":"error"}},methods:d({},Object(c["c"])(["setRefreshFlag","setFwUpdateState"]),{refresh:function(){var t=this;setTimeout(function(){t.setRefreshFlag({refreshFlag:!1})},1e3)},enterFwUpdate:function(t){this.setFwUpdateState(!0),this.currentStep=1},abortFwUpdate:function(){var t=this.$route.path+"?t=".concat(+new Date);this.$router.push({path:t}),this.setFwUpdateState(!1)},stepToUpload:function(t){this.fwSrc?this.currentStep=2:this.fwSrcError="error"},beforeUpload:function(t){return console.log(t),this.fileList=[t],!1},getPrepared:function(){var t=f(i.a.mark(function t(){return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l["l"])();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),Object(l["c"])(this,t.t0,"prepare 失败");case 8:case"end":return t.stop()}},t,this,[[0,5]])}));function e(){return t.apply(this,arguments)}return e}(),download:function(){var t=f(i.a.mark(function t(){var e;return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.tftpAddr&&this.fileName){t.next=5;break}this.tftpAddrError=this.tftpAddr?"":"error",this.fileNameError=this.fileName?"":"error",t.next=16;break;case 5:return e=[this.tftpAddr,this.fileName.trim()],this.fileLoading=!0,t.prev=7,t.next=10,Object(l["d"])({data:e});case 10:this.intervalID=setInterval(this.getUpdateStatus,2e3),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](7),Object(l["c"])(this,t.t0,this.$t("message.fwUpdate.upload_err_msg"));case 16:case"end":return t.stop()}},t,this,[[7,13]])}));function e(){return t.apply(this,arguments)}return e}(),getUpdateStatus:function(){var t=f(i.a.mark(function t(){var e;return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l["j"])();case 3:e=t.sent,console.log(e),e.data.indexOf("Deferred for mounted filesystem. reboot BMC to apply")>=0?(clearInterval(this.intervalID),this.fileLoading=!1,this.imgReady=!0,"local"===this.fwSrc?this.$notification.success({message:this.$t("message.fwUpdate.upload_done"),placement:"bottomRight"}):this.$notification.success({message:this.$t("message.fwUpdate.download_done"),placement:"bottomRight"})):e.data.indexOf("Download Error")>=0&&(clearInterval(this.intervalID),this.fileLoading=!1,"local"===this.fwSrc?this.$notification.error({message:this.$t("message.fwUpdate.upload_err_msg"),description:this.$t("message.fwUpdate.upload_err_msg"),placement:"bottomRight"}):this.$notification.error({message:this.$t("message.fwUpdate.download_err_msg"),description:this.$t("message.fwUpdate.download_err_detail"),placement:"bottomRight"})),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),Object(l["c"])(this,t.t0,"无法查看进度");case 11:case"end":return t.stop()}},t,this,[[0,8]])}));function e(){return t.apply(this,arguments)}return e}(),flashImage:function(){var t=f(i.a.mark(function t(){return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l["b"])();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),Object(l["c"])(this,t.t0,"刷新失败");case 8:case"end":return t.stop()}},t,this,[[0,5]])}));function e(){return t.apply(this,arguments)}return e}(),warmReboot:function(){var t=f(i.a.mark(function t(){return i.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l["m"])();case 3:this.$notification.success({message:this.$t("message.fwUpdate.reboot_done"),placement:"bottomRight"}),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),Object(l["c"])(this,t.t0,this.$t("message.fwUpdate.reboot_done"));case 9:case"end":return t.stop()}},t,this,[[0,6]])}));function e(){return t.apply(this,arguments)}return e}(),handleChange:function(t){}}),components:{ViewContent:o["a"]}},h=m,w=(a("030d"),a("2877")),g=Object(w["a"])(h,r,s,!1,null,"1f91c2f0",null);g.options.__file="fwUpdate.vue";e["default"]=g.exports},"030d":function(t,e,a){"use strict";var r=a("4ecd"),s=a.n(r);s.a},"4ecd":function(t,e,a){},a396:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-row",[a("a-col",{attrs:{span:24}},[a("h1",{staticStyle:{display:"inline-block","margin-right":"10px"}},[t._v(t._s(t.$t("message."+t.message+".title")))]),a("span",{staticStyle:{color:"#9E9E9E"}},[t._v(t._s(t.$t("message."+t.message+".sub_title")))]),a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[a("span",[t._v(t._s(t.$t("message.common.help")))])])],2)],1)],1),a("a-row",[a("a-col",{attrs:{span:24}},[a("a-card",{attrs:{bordered:!1,loading:t.refreshFlag}},[t._t("default")],2)],1)],1)],1)},s=[],n={watch:{lang:function(t){var e=this.$route.path+"?t=".concat(+new Date);this.$router.push({path:e})}}},i={data:function(){return{helpFlag:!1}},methods:{toggleHelp:function(){this.helpFlag=!this.helpFlag}}},o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("transition",{attrs:{name:"custom-classes-transition","enter-active-class":"animated fadeIn"}},[t.helpFlag?a("a-row",{staticClass:"help-msg"},[a("a-col",{attrs:{span:24}},[a("a-card",{attrs:{bordered:!1,bodyStyle:t.helpCardStyle}},[t._t("default")],2)],1)],1):t._e()],1)],1)},c=[],l={name:"helpCard",props:["helpFlag"],data:function(){return{helpCardStyle:{backgroundColor:"#E0F2F1",color:"#0277BD"}}}},p=l,f=a("2877"),d=Object(f["a"])(p,o,c,!1,null,null,null);d.options.__file="helpCard.vue";var u=d.exports,m=a("2f62");function h(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},r=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),r.forEach(function(e){w(t,e,a[e])})}return t}function w(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var g={name:"viewContent",mixins:[n,i],props:["message"],created:function(){this.setRefreshFlag({refreshFlag:!0})},computed:h({},Object(m["b"])({refreshFlag:"getRefreshFlag",lang:"getLang"})),watch:{refreshFlag:function(t){t&&this.$emit("refresh")}},methods:h({},Object(m["c"])(["setRefreshFlag"])),components:{HelpCard:u}},_=g,v=Object(f["a"])(_,r,s,!1,null,null,null);v.options.__file="viewContent.vue";e["a"]=v.exports}}]);